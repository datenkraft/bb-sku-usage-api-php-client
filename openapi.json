{
    "openapi": "3.0.0",
    "info": {
        "title": "SKU Usage API",
        "description": "API to insert usage information to a specific project and SKU",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "UNDEFINED",
            "description": "Production server"
        },
        {
            "url": "UNDEFINED",
            "description": "Staging server"
        },
        {
            "url": "https://localhost:30210",
            "description": "Development server"
        }
    ],
    "paths": {
        "/docs": {
            "get": {
                "tags": [
                    "docs"
                ],
                "summary": "Get the openapi documentation as json",
                "description": "Get the openapi documentation as json",
                "operationId": "getOpenApi",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        },
        "/docs/openapi.{format}": {
            "get": {
                "tags": [
                    "docs"
                ],
                "summary": "Get the openapi documentation in the specified format (yaml or json, fallback is json)",
                "description": "Get the openapi documentation in the specified format (yaml or json, fallback is json)",
                "operationId": "getOpenApiInFormat",
                "parameters": [
                    {
                        "name": "format",
                        "in": "path",
                        "description": "Openapi file format",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "yaml",
                                "json"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/sku-usage": {
            "get": {
                "tags": [
                    "skuUsage"
                ],
                "summary": "Query SKU Usage data by projectId and externalId",
                "description": "Query SKU Usage data by projectId and externalId",
                "operationId": "getSkuUsage",
                "parameters": [
                    {
                        "name": "filter[projectId]",
                        "in": "query",
                        "description": "SKUUsage ProjectId filter",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "filter[externalId]",
                        "in": "query",
                        "description": "SKUUsage ExternalId filter",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/getSkuUsageResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/sku-usage:get"
                        ]
                    }
                ]
            },
            "post": {
                "tags": [
                    "skuUsage"
                ],
                "summary": "Add SKU Usage data",
                "description": "Add SKU Usage data",
                "operationId": "postSkuUsage",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/postSkuUsageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/postSkuUsageResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Unprocessable Entity",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/sku-usage:post"
                        ]
                    }
                ]
            }
        },
        "/task/{taskId}": {
            "get": {
                "tags": [
                    "task"
                ],
                "summary": "Query Task data by taskId",
                "description": "Query Task data by taskId",
                "operationId": "getTask",
                "parameters": [
                    {
                        "name": "taskId",
                        "in": "path",
                        "description": "Task id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/task"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/task:get"
                        ]
                    }
                ]
            },
            "patch": {
                "tags": [
                    "task"
                ],
                "summary": "Update a Task",
                "description": "Update one or more fields of a Task",
                "operationId": "patchTask",
                "parameters": [
                    {
                        "name": "taskId",
                        "in": "path",
                        "description": "Task Id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/updateTask"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/updateResponseTask"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Unprocessable Entity",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/task:patch"
                        ]
                    }
                ]
            }
        },
        "/task/{taskId}/transaction/{transactionId}": {
            "get": {
                "tags": [
                    "transaction"
                ],
                "summary": "Get Transactions from a Task",
                "description": "Get Transactions From a Task",
                "operationId": "getTransaction",
                "parameters": [
                    {
                        "name": "taskId",
                        "in": "path",
                        "description": "Task id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "transactionId",
                        "in": "path",
                        "description": "Transaction id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/task"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/transaction:get"
                        ]
                    }
                ]
            },
            "patch": {
                "tags": [
                    "transaction"
                ],
                "summary": "Update a Transaction",
                "description": "Update one or more fields of a Transaction",
                "operationId": "patchTransaction",
                "parameters": [
                    {
                        "name": "taskId",
                        "in": "path",
                        "description": "Task id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "transactionId",
                        "in": "path",
                        "description": "Transaction id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/patchTransaction"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/patchResponseTransaction"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/transaction:patch"
                        ]
                    }
                ]
            }
        },
        "/task/{taskId}/transaction/sku-usage": {
            "post": {
                "tags": [
                    "transaction"
                ],
                "summary": "Add a Transaction to a Task",
                "description": "Add a Transaction to a Task",
                "operationId": "postTransaction",
                "parameters": [
                    {
                        "name": "taskId",
                        "in": "path",
                        "description": "Task id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/postSkuUsageRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "202": {
                        "description": "Accepted",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/postResponseTransaction"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/errorResponse"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "oAuthAuthorization": [
                            "bb-sku-usage-api/transaction:post"
                        ]
                    }
                ]
            }
        }
    },
    "components": {
        "schemas": {
            "errorResponse": {
                "properties": {
                    "errors": {
                        "description": "errors",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/error"
                        }
                    }
                },
                "type": "object"
            },
            "error": {
                "required": [
                    "code",
                    "message"
                ],
                "properties": {
                    "code": {
                        "description": "Code",
                        "type": "string"
                    },
                    "message": {
                        "description": "Message",
                        "type": "string"
                    },
                    "extra": {
                        "$ref": "#/components/schemas/errorExtra"
                    }
                },
                "type": "object"
            },
            "errorExtra": {
                "properties": {
                    "externalId": {
                        "description": "External Id",
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "skuUsage": {
                "required": [
                    "skuUsageId"
                ],
                "type": "object",
                "allOf": [
                    {
                        "properties": {
                            "skuUsageId": {
                                "description": "SKU Usage Id",
                                "type": "string"
                            }
                        },
                        "type": "object"
                    },
                    {
                        "$ref": "#/components/schemas/newSkuUsage"
                    }
                ]
            },
            "newSkuUsage": {
                "required": [
                    "skuId",
                    "quantity",
                    "projectId",
                    "usageStart",
                    "usageEnd",
                    "externalId"
                ],
                "properties": {
                    "skuId": {
                        "description": "SKU Id",
                        "type": "string"
                    },
                    "quantity": {
                        "description": "Quantity",
                        "type": "integer"
                    },
                    "projectId": {
                        "description": "Project Id",
                        "type": "string"
                    },
                    "usageStart": {
                        "description": "Start time of the usage",
                        "type": "string",
                        "format": "date-time"
                    },
                    "usageEnd": {
                        "description": "End time of the usage",
                        "type": "string",
                        "format": "date-time"
                    },
                    "externalId": {
                        "description": "External Id",
                        "type": "string"
                    },
                    "meta": {
                        "description": "Meta",
                        "type": "object"
                    }
                },
                "type": "object"
            },
            "postSkuUsageRequest": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/newSkuUsage"
                }
            },
            "postSkuUsageResponse": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/skuUsage"
                }
            },
            "getSkuUsageResponse": {
                "description": "Class SkuUsageResource",
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/skuUsage"
                }
            },
            "updateTask": {
                "required": [
                    "taskStatus"
                ],
                "properties": {
                    "taskStatus": {
                        "description": "Task Status",
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "updateResponseTask": {
                "description": "Class PatchTaskResource",
                "required": [
                    "taskId",
                    "taskStatus"
                ],
                "properties": {
                    "taskId": {
                        "description": "Task Id",
                        "type": "string"
                    },
                    "taskStatus": {
                        "description": "Task Status",
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "task": {
                "description": "Class TaskResource",
                "required": [
                    "taskId",
                    "taskStatus",
                    "entryCount",
                    "transactions"
                ],
                "properties": {
                    "taskId": {
                        "description": "Task Id",
                        "type": "string"
                    },
                    "taskStatus": {
                        "description": "Task Status",
                        "type": "string"
                    },
                    "entryCount": {
                        "description": "Entry Count",
                        "type": "integer"
                    },
                    "transactions": {
                        "$ref": "#/components/schemas/patchResponseTransaction"
                    }
                },
                "type": "object"
            },
            "patchTransaction": {
                "required": [
                    "transactionSeen"
                ],
                "properties": {
                    "transactionSeen": {
                        "description": "Transaction has been seen",
                        "type": "boolean"
                    }
                },
                "type": "object"
            },
            "patchResponseTransaction": {
                "description": "Class PatchTransactionResource",
                "required": [
                    "transactionId",
                    "transactionStatus",
                    "transactionSeen"
                ],
                "properties": {
                    "transactionId": {
                        "description": "Transaction Id",
                        "type": "string"
                    },
                    "transactionStatus": {
                        "description": "Transaction Status",
                        "type": "string"
                    },
                    "transactionSeen": {
                        "description": "Transaction has been seen",
                        "type": "boolean"
                    }
                },
                "type": "object"
            },
            "postResponseTransaction": {
                "description": "Class PostTransactionResource",
                "required": [
                    "transactionId"
                ],
                "properties": {
                    "transactionId": {
                        "description": "Transaction Id",
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "transaction": {
                "description": "Class TransactionResource",
                "properties": {
                    "taskId": {
                        "description": "Transaction Id",
                        "type": "string"
                    },
                    "transactionStatus": {
                        "description": "Transaction Status",
                        "type": "string"
                    },
                    "transactionResourceType": {
                        "description": "Transaction Resource Type",
                        "type": "string"
                    },
                    "entryCount": {
                        "description": "Entry Count",
                        "type": "integer"
                    },
                    "requestData": {
                        "description": "Request Data",
                        "type": "object"
                    },
                    "responseData": {
                        "description": "Response Data",
                        "type": "object"
                    }
                },
                "type": "object"
            }
        },
        "securitySchemes": {
            "oAuthAuthorization": {
                "type": "oauth2",
                "description": "OAuth2 Authorization",
                "flows": {
                    "clientCredentials": {
                        "tokenUrl": "https://localhost:30250/oauth/token",
                        "refreshUrl": "UNDEFINED",
                        "scopes": {
                            "bb-sku-usage-api/sku-usage:get": "Get SKU Usages from the SKU Usage API",
                            "bb-sku-usage-api/sku-usage:post": "Add SKU Usages to the SKU Usage API"
                        }
                    }
                }
            }
        }
    }
}